<script>
	import { AppRail, getDrawerStore } from '@skeletonlabs/skeleton';
	import parts from './PagesRail.json';
	import { page } from '$app/stores';
	import NavIco from '$lib/utils/NavIco.svelte';

	$: isRoot = $page.route.id == '/admin';

	const drawerStore = getDrawerStore();
</script>

<AppRail
	width="w-auto"
	height="h-[100%]"
	background="dark:bg-surface-800 bg-surface-100"
	class="border-r-[0.5px] dark:border-surface-600 border-surface-200 p-4 "
	active="dark:bg-surface-900"
	hover="hover:bg-surface-900"
>
	{#each parts as tiles, i}
		{#each tiles as tile}
			{@const url = tile.url.length ? `${tile.url}/` : ''}
			<a
				href={`${isRoot ? '' : '../'}${url}`}
				class="nav-links"
				class:bg={url == '' ? isRoot : $page.url.pathname.endsWith(url)}
				on:click={drawerStore.close}
			>
				<NavIco icon={tile.icon} />
				<span class="text-links-style">{tile.title}</span>
			</a>
		{/each}

		{#if i < parts.length - 1}
			<div class="col-span-2 flex my-5 p-3">
				<separator class="border-[1px] flex w-[70%] dark:border-surface-300 border-surface-400" />
			</div>
		{/if}
	{/each}
</AppRail>

<style lang="postcss">
	.nav-links {
		@apply flex justify-start p-[5px] mt-1 px-2 items-center dark:hover:bg-surface-700 hover:bg-surface-50 rounded-token;
	}
	.text-links-style {
		@apply font-extralight font-normal ml-3 text-start text-[14px];
	}
	.bg {
		@apply bg-primary-500 bg-opacity-30 dark:bg-primary-500 dark:bg-opacity-20 dark:text-primary-200 text-primary-900 font-bold !important;
	}
</style>
