<script module>
	import ConvertigoLogo from './icons/logo.svg?raw';
	import MaterialSymbolsApiRounded from '~icons/mdi/api?raw';
	import MaterialSymbolsBookmarkAddedOutlineSharp from '~icons/mdi/bookmark-check-outline?raw';
	import MaterialSymbolsCachedRounded from '~icons/mdi/cached?raw';
	import MaterialSymbolsDashboardOutlineRounded from '~icons/mdi/view-dashboard-outline?raw';
	import MaterialSymbolsDataObject from '~icons/mdi/code-braces?raw';
	import MaterialSymbolsDeviceHub from '~icons/mdi/hub?raw';
	import MaterialSymbolsHotelClassOutline from '~icons/mdi/star-outline?raw';
	import MaterialSymbolsLightCancelOutline from '~icons/mdi/close-circle-outline?raw';
	import MaterialSymbolsLightDateRangeRounded from '~icons/mdi/calendar-range?raw';
	import MaterialSymbolsLightSaveAsOutline from '~icons/mdi/content-save-edit-outline?raw';
	import MaterialSymbolsLightSyncOutline from '~icons/mdi/sync?raw';
	import MaterialSymbolsOnlinePredictionRounded from '~icons/mdi/brain?raw';
	import MaterialSymbolsSettingsOutlineRounded from '~icons/mdi/cog-outline?raw';
	import MaterialSymbolsSupervisedUserCircleOutline from '~icons/mdi/account-supervisor-circle-outline?raw';
	import MaterialSymbolsSyncArrowUpRounded from '~icons/mdi/cloud-sync-outline?raw';
	import MaterialSymbolsUnknownDocumentOutline from '~icons/mdi/file-question-outline?raw';
	import MdiApplicationOutline from '~icons/mdi/application-outline?raw';
	import MdiArrowULeftTop from '~icons/mdi/arrow-u-left-top?raw';
	import MdiBackupRestore from '~icons/mdi/backup-restore?raw';
	import MdiBookMultiple from '~icons/mdi/book-multiple?raw';
	import MdiBookOpenVariant from '~icons/mdi/book-open-variant?raw';
	import MdiBriefcaseUploadOutline from '~icons/mdi/briefcase-upload-outline?raw';
	import MdiBroom from '~icons/mdi/broom?raw';
	import MdiCalendarClock from '~icons/mdi/calendar-clock?raw';
	import MdiCertificate from '~icons/mdi/certificate?raw';
	import MdiCheckAll from '~icons/mdi/check-all?raw';
	import MdiClockStarFourPointsOutline from '~icons/mdi/clock-star-four-points-outline?raw';
	import MdiCloudOutline from '~icons/mdi/cloud-outline?raw';
	import MdiCodeBlockBraces from '~icons/mdi/code-block-braces?raw';
	import MdiCoffee from '~icons/mdi/coffee?raw';
	import MdiCog from '~icons/mdi/cog?raw';
	import MdiDatabase from '~icons/mdi/database?raw';
	import MdiDeleteOutline from '~icons/mdi/delete-outline?raw';
	import MdiDotsVertical from '~icons/mdi/dots-vertical?raw';
	import MdiEditOutline from '~icons/mdi/edit-outline?raw';
	import MdiEmoticonHappyOutline from '~icons/mdi/emoticon-happy-outline?raw';
	import MdiExport from '~icons/mdi/export?raw';
	import MdiEye from '~icons/mdi/eye?raw';
	import MdiEyeOff from '~icons/mdi/eye-off?raw';
	import MdiFilter from '~icons/mdi/filter?raw';
	import MdiFilterCog from '~icons/mdi/filter-cog?raw';
	import MdiFolderOutline from '~icons/mdi/folder-outline?raw';
	import MdiFullscreen from '~icons/mdi/fullscreen?raw';
	import MdiGithub from '~icons/mdi/github?raw';
	import MdiHomeOutline from '~icons/mdi/home-outline?raw';
	import MdiImport from '~icons/mdi/import?raw';
	import MdiInvoiceScheduledOutline from '~icons/mdi/invoice-scheduled-outline?raw';
	import MdiKeyOutline from '~icons/mdi/key-outline?raw';
	import MdiLanguageJava from '~icons/mdi/language-java?raw';
	import MdiLanguageRuby from '~icons/mdi/language-ruby?raw';
	import MdiLayersOutline from '~icons/mdi/layers-outline?raw';
	import MdiLock from '~icons/mdi/lock?raw';
	import MdiLockOpenVariant from '~icons/mdi/lock-open-variant?raw';
	import MdiMagnify from '~icons/mdi/magnify?raw';
	import MdiMarketplaceOutline from '~icons/mdi/marketplace-outline?raw';
	import MdiMenu from '~icons/mdi/menu?raw';
	import MdiMinus from '~icons/mdi/minus?raw';
	import MdiMoonAndStars from '~icons/mdi/moon-and-stars?raw';
	import MdiPackageVariantClosed from '~icons/mdi/package-variant-closed?raw';
	import MdiPlayCircleOutline from '~icons/mdi/play-circle-outline?raw';
	import MdiPlus from '~icons/mdi/plus?raw';
	import MdiPowerPlug from '~icons/mdi/power-plug?raw';
	import MdiReceiptTextSendOutline from '~icons/mdi/receipt-text-send-outline?raw';
	import MdiReload from '~icons/mdi/reload?raw';
	import MdiResizeHorizontal from '~icons/mdi/resize-horizontal?raw';
	import MdiSearch from '~icons/mdi/search?raw';
	import MdiStarThreePointsOutline from '~icons/mdi/star-three-points-outline?raw';
	import MdiTable from '~icons/mdi/table?raw';
	import MdiUnfoldMoreHorizontal from '~icons/mdi/unfold-more-horizontal?raw';
	import MdiUpdate from '~icons/mdi/update?raw';
	import MdiVideoOutline from '~icons/mdi/video-outline?raw';
	import MdiWarningOutline from '~icons/mdi/warning-outline?raw';
	import MdiWeatherSunny from '~icons/mdi/weather-sunny?raw';
	import MdiWrench from '~icons/mdi/wrench?raw';

	export const ico = {
		'convertigo:logo': ConvertigoLogo,
		'mdi:account-supervisor-circle-outline': MaterialSymbolsSupervisedUserCircleOutline,
		'mdi:api': MaterialSymbolsApiRounded,
		'mdi:application-outline': MdiApplicationOutline,
		'mdi:arrow-u-left-top': MdiArrowULeftTop,
		'mdi:backup-restore': MdiBackupRestore,
		'mdi:book-multiple': MdiBookMultiple,
		'mdi:book-open-variant': MdiBookOpenVariant,
		'mdi:bookmark-check-outline': MaterialSymbolsBookmarkAddedOutlineSharp,
		'mdi:brain': MaterialSymbolsOnlinePredictionRounded,
		'mdi:briefcase-upload-outline': MdiBriefcaseUploadOutline,
		'mdi:broom': MdiBroom,
		'mdi:cached': MaterialSymbolsCachedRounded,
		'mdi:calendar-clock': MdiCalendarClock,
		'mdi:calendar-range': MaterialSymbolsLightDateRangeRounded,
		'mdi:certificate': MdiCertificate,
		'mdi:check-all': MdiCheckAll,
		'mdi:clock-star-four-points-outline': MdiClockStarFourPointsOutline,
		'mdi:close-circle-outline': MaterialSymbolsLightCancelOutline,
		'mdi:cloud-outline': MdiCloudOutline,
		'mdi:cloud-sync-outline': MaterialSymbolsSyncArrowUpRounded,
		'mdi:code-block-braces': MdiCodeBlockBraces,
		'mdi:code-braces': MaterialSymbolsDataObject,
		'mdi:coffee': MdiCoffee,
		'mdi:cog-outline': MaterialSymbolsSettingsOutlineRounded,
		'mdi:cog': MdiCog,
		'mdi:content-save-edit-outline': MaterialSymbolsLightSaveAsOutline,
		'mdi:database': MdiDatabase,
		'mdi:delete-outline': MdiDeleteOutline,
		'mdi:dots-vertical': MdiDotsVertical,
		'mdi:edit-outline': MdiEditOutline,
		'mdi:emoticon-happy-outline': MdiEmoticonHappyOutline,
		'mdi:export': MdiExport,
		'mdi:eye-off': MdiEyeOff,
		'mdi:eye': MdiEye,
		'mdi:file-question-outline': MaterialSymbolsUnknownDocumentOutline,
		'mdi:filter-cog': MdiFilterCog,
		'mdi:filter': MdiFilter,
		'mdi:folder-outline': MdiFolderOutline,
		'mdi:fullscreen': MdiFullscreen,
		'mdi:github': MdiGithub,
		'mdi:home-outline': MdiHomeOutline,
		'mdi:hub': MaterialSymbolsDeviceHub,
		'mdi:import': MdiImport,
		'mdi:invoice-scheduled-outline': MdiInvoiceScheduledOutline,
		'mdi:key-outline': MdiKeyOutline,
		'mdi:language-java': MdiLanguageJava,
		'mdi:language-ruby': MdiLanguageRuby,
		'mdi:layers-outline': MdiLayersOutline,
		'mdi:lock-open-variant': MdiLockOpenVariant,
		'mdi:lock': MdiLock,
		'mdi:magnify': MdiMagnify,
		'mdi:marketplace-outline': MdiMarketplaceOutline,
		'mdi:menu': MdiMenu,
		'mdi:minus': MdiMinus,
		'mdi:moon-and-stars': MdiMoonAndStars,
		'mdi:package-variant-closed': MdiPackageVariantClosed,
		'mdi:play-circle-outline': MdiPlayCircleOutline,
		'mdi:plus': MdiPlus,
		'mdi:power-plug': MdiPowerPlug,
		'mdi:receipt-text-send-outline': MdiReceiptTextSendOutline,
		'mdi:reload': MdiReload,
		'mdi:resize-horizontal': MdiResizeHorizontal,
		'mdi:search': MdiSearch,
		'mdi:star-outline': MaterialSymbolsHotelClassOutline,
		'mdi:star-three-points-outline': MdiStarThreePointsOutline,
		'mdi:sync': MaterialSymbolsLightSyncOutline,
		'mdi:table': MdiTable,
		'mdi:unfold-more-horizontal': MdiUnfoldMoreHorizontal,
		'mdi:update': MdiUpdate,
		'mdi:video-outline': MdiVideoOutline,
		'mdi:view-dashboard-outline': MaterialSymbolsDashboardOutlineRounded,
		'mdi:warning-outline': MdiWarningOutline,
		'mdi:weather-sunny': MdiWeatherSunny,
		'mdi:wrench': MdiWrench
	};
</script>

<script>
	import { browser } from '$app/environment';
	import { asset } from '$app/paths';

	/** @type {{icon: string, size?: string|number, class?: string, animate?: boolean|import('svelte/transition').DrawParams , repeat?: boolean, strokeWidth?: any} | any} */
	let {
		icon,
		size = 4,
		class: cls = '',
		// animate = false,
		// repeat = false,
		// strokeWidth = undefined
		...props
	} = $props();

	if (size == 'btn') {
		size = 6;
	} else if (['nav', 'dashboard'].includes(size)) {
		size = 5;
	}

	// let _animate = $state({ duration: 2000 });
	// let svg = $state(null);
	// let show = $state(false);
	// if (animate) {
	// 	if (animate != true) {
	// 		// @ts-ignore
	// 		_animate = animate;
	// 	}
	// 	onMount(() => {
	// 		svg = new DOMParser().parseFromString(ico[icon], 'image/svg+xml').documentElement;
	// 		let interval;
	// 		if (repeat) {
	// 			interval = window.setInterval(() => {
	// 				show = !show;
	// 			}, _animate.duration);
	// 		}
	// 		tick().then(() => (show = true));
	// 		return () => window.clearInterval(interval);
	// 	});
	// }
	// function attrToObj(element) {
	// 	return [...element.attributes].reduce((acc, attr) => {
	// 		acc[attr.name] = attr.value;
	// 		return acc;
	// 	}, {});
	// }
	// console.log('ConvertigoLogo', ConvertigoLogo);
	// console.log('MdiScanner', MdiScanner);
	let html = $derived(icon.includes(':') ? ico[icon].match(/>(.*)</)?.[1] : undefined);
</script>

{#if html}
	<svg
		class="ico {cls}"
		style="width: calc(var(--spacing)*{size});height: calc(var(--spacing)*{size});"
		viewBox={ico[icon].match(/viewBox="([^"]+)"/)?.[1]}
	>
		{#if browser}
			{@html html}
		{:else}
			{@html html}
		{/if}
	</svg>
{:else}
	<img src={asset(`/${icon}`)} class={cls} style="width: calc(var(--spacing)*{size});" {...props} />
{/if}

<!-- {#if !svg || !animate}
	{@html ico[icon].replace('class="', `class="w-${size} h-${size} ${cls} `)}
{:else}
	<svg {...attrToObj(svg)} class={`${svg.getAttribute('class') ?? ''} w-${size} h-${size} ${cls} `}>
		{#each svg.children as child}
			{#if ['path', 'polyline'].includes(child.tagName)}
				{#if show}
					<svelte:element
						this={child.tagName}
						transition:draw={_animate}
						{...attrToObj(child)}
						fill="none"
						stroke="currentColor"
						stroke-linejoin="round"
						stroke-width={strokeWidth}
					/>
				{/if}
			{:else}
				{@html child.outerHTML}
			{/if}
		{/each}
	</svg>
{/if} -->
